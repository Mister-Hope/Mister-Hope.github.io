import{_ as l}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,b as a,a as o,o as p,r as t}from"./app-BGIrljxn.js";const c="/assets/learn-branches-mV5O8qPv.png",r="/assets/git6-C-34ENlG.png",i="/assets/git7-CQoIyFRu.png",d="/assets/git8-BtIJv3Zi.png",y="/assets/git9-DIzH93qI.png",E="/assets/git10-Y4pG_fvH.png",C="/assets/git11-Cqxncf4z.png",A="/assets/git12-CnkclJyB.png",B="/assets/git13-2pEbtKDD.png",h="data:image/png;base64,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",g={};function u(v,s){const n=t("Mermaid");return p(),e("div",null,[s[0]||(s[0]=a('<h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述"><span>概述</span></a></h2><p>分支就是科幻电影里面的平行宇宙，当您正在电脑前努力学习 Git 的时候，另一个您正在另一个平行宇宙里努力学习 SVN。</p><p>如果两个平行宇宙互不干扰，那对现在的您也没啥影响。不过，在某个时间点，两个平行宇宙合并了，结果，您既学会了 Git 又学会了 SVN!</p><figure><img src="'+c+'" alt="Learn branches" tabindex="0" loading="lazy"><figcaption>Learn branches</figcaption></figure><p>分支在实际中有什么用呢? 假设您准备开发一个新功能，但是需要两周才能完成，第一周您写了 50% 的代码，如果立刻提交，由于代码还没写完，不完整的代码库会导致别人不能干活了。如果等代码全部写完再一次提交，又存在丢失每天进度的巨大风险。</p><p>现在有了分支，就不用怕了。您创建了一个属于您自己的分支，别人看不到，还继续在原来的分支上正常工作，而您在自己的分支上干活，想提交就提交，直到开发完毕后，再一次性合并到原来的分支上，这样，既安全，又不影响别人工作。</p><p>其他版本控制系统如 SVN 等都有分支管理，但是用过之后您会发现，这些版本控制系统创建和切换分支比蜗牛还慢，简直让人无法忍受，结果分支功能成了摆设，大家都不去用。</p><p>但 Git 的分支是与众不同的，无论创建、切换和删除分支，Git 在 1 秒钟之内就能完成! 无论您的版本库是 1 个文件还是 1 万个文件。</p><h2 id="创建与合并分支" tabindex="-1"><a class="header-anchor" href="#创建与合并分支"><span>创建与合并分支</span></a></h2><p>在版本回退里，您已经知道，每次提交，Git 都把它们串成一条时间线，这条时间线就是一个分支。截止到目前，只有一条时间线，在 Git 里，这个分支叫主分支，即 <code>master</code> 分支。<code>HEAD</code> 严格来说不是指向提交，而是指向 <code>master</code>，<code>master</code> 才是指向提交的，所以，<code>HEAD</code> 指向的就是当前分支。</p><p>一开始的时候，<code>master</code> 分支是一条线，Git 用 <code>master</code> 指向最新的提交，再用 <code>HEAD</code> 指向 <code>master</code>，就能确定当前分支，以及当前分支的提交点:</p><figure><img src="'+r+'" alt="示意图" tabindex="0" loading="lazy"><figcaption>示意图</figcaption></figure><p>每次提交，<code>master</code> 分支都会向前移动一步，这样，随着您不断提交，<code>master</code> 分支的线也越来越长:</p><p>当我们创建新的分支，例如 dev 时，Git 新建了一个指针叫 <code>dev</code>，指向 <code>master</code> 相同的提交，再把 <code>HEAD</code> 指向 <code>dev</code>，就表示当前分支在 dev 上:</p><figure><img src="'+i+'" alt="示意图" tabindex="0" loading="lazy"><figcaption>示意图</figcaption></figure><p>您看，Git 创建一个分支很快，因为除了增加一个 <code>dev</code> 指针，改改 <code>HEAD</code> 的指向，工作区的文件都没有任何变化!</p><p>不过，从现在开始，对工作区的修改和提交就是针对 dev 分支了，比如新提交一次后，<code>dev</code> 指针往前移动一步，而 <code>master</code> 指针不变:</p><figure><img src="'+d+'" alt="示意图" tabindex="0" loading="lazy"><figcaption>示意图</figcaption></figure><p>假如我们在 dev 上的工作完成了，就可以把 dev 合并到 master 上。Git 怎么合并呢? 最简单的方法，就是直接把 master 指向 dev 的当前提交，就完成了合并:</p><figure><img src="'+y+'" alt="示意图" tabindex="0" loading="lazy"><figcaption>示意图</figcaption></figure><p>所以 Git 合并分支也很快! 就改改指针，工作区内容也不变!</p><p>合并完分支后，甚至可以删除 dev 分支。删除 dev 分支就是把 dev 指针给删掉，删掉后，我们就剩下了一条 master 分支:</p><figure><img src="'+E+`" alt="示意图" tabindex="0" loading="lazy"><figcaption>示意图</figcaption></figure><p>下面开始实战。首先，我们创建 dev 分支，然后切换到 dev 分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> -b</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> a</span><span style="color:#A3BE8C;"> new</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">dev</span><span style="color:#ECEFF4;">&#39;</span></span></code></pre></div><p><code>git checkout</code> 命令加上 <code>-b</code> 参数表示创建并切换，相当于以下两条命令:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#616E88;"># nothing</span></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">dev</span><span style="color:#ECEFF4;">&#39;</span></span></code></pre></div><p>然后，用 <code>git branch</code> 命令查看当前分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> branch</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">  master</span></span></code></pre></div><p><code>git branch</code> 命令会列出所有分支，当前分支前面会标一个 <code>*</code> 号。</p><p>然后，我们就可以在 dev 分支上正常提交，比如对 <code>readme.txt</code> 做个修改，加上一行:</p><div class="language-md" data-highlighter="shiki" data-ext="md" data-title="md" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Creating a new branch is quick.</span></span></code></pre></div><p>然后提交:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> readme.txt</span></span>
<span class="line"><span style="color:#616E88;"># nothing</span></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">branch test</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">dev b17d20e</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;"> branch test</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span></span></code></pre></div><p>现在，dev 分支的工作完成，我们就可以切换回 master 分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> master</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">master</span><span style="color:#ECEFF4;">&#39;</span></span></code></pre></div><p>切换回 master 分支后，再查看一个 <code>readme.txt</code> 文件，刚才添加的内容不见了! 因为那个提交是在 dev 分支上，而 master 分支此刻的提交点并没有变:</p><figure><img src="`+C+`" alt="示例图" tabindex="0" loading="lazy"><figcaption>示例图</figcaption></figure><p>现在，我们把 dev 分支的工作成果合并到 master 分支上:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> merge</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Updating</span><span style="color:#A3BE8C;"> d46f35e..b17d20e</span></span>
<span class="line"><span style="color:#88C0D0;">Fast-forward</span></span>
<span class="line"><span style="color:#88C0D0;"> readme.txt</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> +</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span></span></code></pre></div><p><code>git merge</code> 命令用于合并指定分支到当前分支。合并后，再查看 readme.txt 的内容，就可以看到，和 dev 分支的最新提交是完全一样的。</p><p>注意到上面的 <code>Fast-forward</code> 信息，Git 告诉我们，这次合并是 “快进模式”，也就是直接把 master 指向 dev 的当前提交，所以合并速度非常快。当然，也不是每次合并都能 <code>Fast-forward</code>。合并完成后，就可以放心地删除 dev 分支了:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> -d</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Deleted</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> dev</span><span style="color:#D8DEE9FF;"> (was </span><span style="color:#A3BE8C;">b17d20e</span><span style="color:#D8DEE9FF;">).</span></span></code></pre></div><p>删除后，查看 <code>branch</code>，就只剩下 <code>master</code> 分支了:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> branch</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> master</span></span></code></pre></div><p>因为创建、合并和删除分支非常快，所以 Git 鼓励您使用分支完成某个任务，合并后再删掉分支，这和直接在 <code>master</code> 分支上工作效果是一样的，但过程更安全。</p><h3 id="分支小结" tabindex="-1"><a class="header-anchor" href="#分支小结"><span>分支小结</span></a></h3><ul><li><p>查看分支: <code>git branch</code></p></li><li><p>创建分支: <code>git branch &lt;name&gt;</code></p></li><li><p>切换分支: <code>git checkout &lt;name&gt;</code></p></li><li><p>创建+切换分支: <code>git checkout -b &lt;name&gt;</code></p></li><li><p>合并某分支到当前分支: <code>git merge &lt;name&gt;</code></p></li><li><p>删除分支: <code>git branch -d &lt;name&gt;</code></p></li></ul><hr><h2 id="冲突" tabindex="-1"><a class="header-anchor" href="#冲突"><span>冲突</span></a></h2><p>人生不如意之事十之八九，合并分支往往也不是一帆风顺的。</p><p>准备新的 <code>feature1</code> 分支，继续我们的新分支开发:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> -b</span><span style="color:#A3BE8C;"> feature1</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> a</span><span style="color:#A3BE8C;"> new</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">feature1</span><span style="color:#ECEFF4;">&#39;</span></span></code></pre></div><p>修改 readme.txt 最后一行，改为:</p><div class="language-md" data-highlighter="shiki" data-ext="md" data-title="md" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Creating a new branch is quick AND simple.</span></span></code></pre></div><p>在 <code>feature1</code> 分支上提交:</p><div class="language-md" data-highlighter="shiki" data-ext="md" data-title="md" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">git add readme.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D8DEE9FF;">\\$ git commit -m &quot;AND simple&quot;</span></span>
<span class="line"><span style="color:#D8DEE9FF;">[feature1 14096d0] AND simple</span></span>
<span class="line"><span style="color:#D8DEE9FF;">1 file changed, 1 insertion(+), 1 deletion(-)</span></span></code></pre></div><p>切换到 <code>master</code> 分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> master</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">master</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">Your</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> is</span><span style="color:#A3BE8C;"> ahead</span><span style="color:#A3BE8C;"> of</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">origin/master</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> by</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> commit.</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git push</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> publish</span><span style="color:#A3BE8C;"> your</span><span style="color:#A3BE8C;"> local</span><span style="color:#A3BE8C;"> commits</span><span style="color:#ECEFF4;">)</span></span></code></pre></div><p>Git 还会自动提示我们当前 <code>master</code> 分支比远程的 <code>master</code> 分支要超前 1 个提交。</p><p>在 <code>master</code> 分支上把 readme.txt 文件的最后一行改为:</p><div class="language-md" data-highlighter="shiki" data-ext="md" data-title="md" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Creating a new branch is quick &amp; simple.</span></span></code></pre></div><p>提交:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> readme.txt</span></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">&amp; simple</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">master 5dc6824</span><span style="color:#ECEFF4;">]</span><span style="color:#ECEFF4;"> &amp;</span><span style="color:#88C0D0;"> simple</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span><span style="color:#A3BE8C;">,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> deletion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">-</span><span style="color:#ECEFF4;">)</span></span></code></pre></div><p>现在，<code>master</code> 分支和 <code>feature1</code> 分支各自都分别有新的提交，变成了这样:</p><figure><img src="`+A+`" alt="示例图" tabindex="0" loading="lazy"><figcaption>示例图</figcaption></figure><p>这种情况下，Git 无法执行“快速合并”，只能试图把各自的修改合并起来，但这种合并就可能会有冲突，我们试试看:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> merge</span><span style="color:#A3BE8C;"> feature1</span></span>
<span class="line"><span style="color:#88C0D0;">Auto-merging</span><span style="color:#A3BE8C;"> readme.txt</span></span>
<span class="line"><span style="color:#88C0D0;">CONFLICT</span><span style="color:#D8DEE9FF;"> (content): Merge conflict in readme.txt</span></span>
<span class="line"><span style="color:#88C0D0;">Automatic</span><span style="color:#A3BE8C;"> merge</span><span style="color:#A3BE8C;"> failed</span><span style="color:#81A1C1;">;</span><span style="color:#88C0D0;"> fix</span><span style="color:#A3BE8C;"> conflicts</span><span style="color:#A3BE8C;"> and</span><span style="color:#A3BE8C;"> then</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> the</span><span style="color:#A3BE8C;"> result.</span></span></code></pre></div><p>果然冲突了! Git 告诉我们，<code>readme.txt</code> 文件存在冲突，必须手动解决冲突后再提交。<code>git status</code> 也可以告诉我们冲突的文件:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> status</span></span>
<span class="line"><span style="color:#88C0D0;">On</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> master</span></span>
<span class="line"><span style="color:#88C0D0;">Your</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> is</span><span style="color:#A3BE8C;"> ahead</span><span style="color:#A3BE8C;"> of</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">origin/master</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> by</span><span style="color:#B48EAD;"> 2</span><span style="color:#A3BE8C;"> commits.</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git push</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> publish</span><span style="color:#A3BE8C;"> your</span><span style="color:#A3BE8C;"> local</span><span style="color:#A3BE8C;"> commits</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">You</span><span style="color:#A3BE8C;"> have</span><span style="color:#A3BE8C;"> unmerged</span><span style="color:#A3BE8C;"> paths.</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">fix</span><span style="color:#A3BE8C;"> conflicts</span><span style="color:#A3BE8C;"> and</span><span style="color:#A3BE8C;"> run</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git commit</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git merge --abort</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> abort</span><span style="color:#A3BE8C;"> the</span><span style="color:#A3BE8C;"> merge</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">Unmerged</span><span style="color:#A3BE8C;"> paths:</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git add &lt;file&gt;...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> mark</span><span style="color:#A3BE8C;"> resolution</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">    both</span><span style="color:#A3BE8C;"> modified:</span><span style="color:#A3BE8C;">   readme.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">no</span><span style="color:#A3BE8C;"> changes</span><span style="color:#A3BE8C;"> added</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> commit</span><span style="color:#D8DEE9FF;"> (use </span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;">git add</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> and/or</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git commit -a</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#D8DEE9FF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以直接查看 readme.txt 的内容:</p><div class="language-diff" data-highlighter="shiki" data-ext="diff" data-title="diff" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Git is a distributed version control system.</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Git is free software distributed under the GPL.</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Git has a mutable index called stage.</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Git tracks changes of files.</span></span>
<span class="line"><span style="color:#D8DEE9FF;">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Creating a new branch is quick &amp; simple.</span></span>
<span class="line"><span style="color:#D8DEE9FF;">=======</span></span>
<span class="line"><span style="color:#D8DEE9FF;">Creating a new branch is quick AND simple.</span></span>
<span class="line"><span style="color:#D8DEE9FF;">&gt;&gt;&gt;&gt;&gt;&gt;&gt; feature1</span></span></code></pre></div><p>Git 用 <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>，<code>=======</code>，<code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code> 标记出不同分支的内容，我们修改如下后保存:</p><div class="language-md" data-highlighter="shiki" data-ext="md" data-title="md" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#D8DEE9FF;">Creating a new branch is quick and simple.</span></span></code></pre></div><p>再提交:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> readme.txt</span></span>
<span class="line"><span style="color:#616E88;"># nothing</span></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">conflict fixed</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">master cf810e4</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;"> conflict fixed</span></span></code></pre></div><p>现在，<code>master</code> 分支和 <code>feature1</code> 分支变成了下图所示:</p><figure><img src="`+B+`" alt="示例图" tabindex="0" loading="lazy"><figcaption>示例图</figcaption></figure><p>用带参数的 <code>git log</code> 也可以看到分支的合并情况:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> log</span><span style="color:#A3BE8C;"> --graph</span><span style="color:#A3BE8C;"> --pretty=oneline</span><span style="color:#A3BE8C;"> --abbrev-commit</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">   cf810e4 (</span><span style="color:#88C0D0;">HEAD</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> master</span><span style="color:#D8DEE9FF;">) conflict fixed</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#EBCB8B;">\\</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> *</span><span style="color:#A3BE8C;"> 14096d0</span><span style="color:#D8DEE9FF;"> (feature1) AND simple</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 5dc6824</span><span style="color:#ECEFF4;"> &amp;</span><span style="color:#88C0D0;"> simple</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;">/</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> b17d20e branch test</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> d46f35e (</span><span style="color:#88C0D0;">origin/master</span><span style="color:#D8DEE9FF;">) remove test.txt</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> b84166e add test.txt</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> 519219b git tracks changes</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> e43a48b understand how stage works</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> 1094adb append GPL</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> e475afc add distributed</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> eaadf4e wrote a readme file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最后，删除 feature1 分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> -d</span><span style="color:#A3BE8C;"> feature1</span></span>
<span class="line"><span style="color:#88C0D0;">Deleted</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> feature1</span><span style="color:#D8DEE9FF;"> (was </span><span style="color:#A3BE8C;">14096d0</span><span style="color:#D8DEE9FF;">).</span></span></code></pre></div><h3 id="冲突小结" tabindex="-1"><a class="header-anchor" href="#冲突小结"><span>冲突小结</span></a></h3><ul><li><p>当 Git 无法自动合并分支时，就必须首先解决冲突。解决冲突后，再提交，合并完成。解决冲突就是把 Git 合并失败的文件手动编辑为我们希望的内容，再提交。</p></li><li><p>用 <code>git log --graph</code> 命令可以看到分支合并图。</p></li></ul><h2 id="分支管理策略" tabindex="-1"><a class="header-anchor" href="#分支管理策略"><span>分支管理策略</span></a></h2><p>通常，合并分支时，如果可能，Git 会用 <code>Fast forward</code> 模式，但这种模式下，删除分支后，会丢掉分支信息。</p><p>如果要强制禁用 <code>Fast forward</code> 模式，Git 就会在 merge 时生成一个新的 commit，这样，从分支历史上就可以看出分支信息。</p><p>实战一下 <code>--no-ff</code> 方式的 <code>git merge</code>。首先，仍然创建并切换 <code>dev</code> 分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> -b</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> a</span><span style="color:#A3BE8C;"> new</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">dev</span><span style="color:#ECEFF4;">&#39;</span></span></code></pre></div><p>修改 readme.txt 文件，并提交一个新的 <code>commit</code>:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> readme.txt</span></span>
<span class="line"><span style="color:#616E88;"># nothing</span></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">add merge</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">dev f52c633</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;"> add merge</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span></span></code></pre></div><p>现在，我们切换回 <code>master</code>:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> master</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">master</span><span style="color:#ECEFF4;">&#39;</span></span></code></pre></div><p>准备合并 <code>dev</code> 分支，请注意 <code>--no-ff</code> 参数，表示禁用 <code>Fast forward</code>:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> merge</span><span style="color:#A3BE8C;"> --no-ff</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">merge with no-ff</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Merge</span><span style="color:#A3BE8C;"> made</span><span style="color:#A3BE8C;"> by</span><span style="color:#A3BE8C;"> the</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">recursive</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> strategy.</span></span>
<span class="line"><span style="color:#88C0D0;"> readme.txt</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> +</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span></span></code></pre></div><p>因为本次合并要创建一个新的 <code>commit</code>，所以加上 <code>-m</code> 参数，把 <code>commit</code> 描述写进去。</p><p>合并后，我们用 <code>git log</code> 看看分支历史:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> log</span><span style="color:#A3BE8C;"> --graph</span><span style="color:#A3BE8C;"> --pretty=oneline</span><span style="color:#A3BE8C;"> --abbrev-commit</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">   e1e9c68 (</span><span style="color:#88C0D0;">HEAD</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> master</span><span style="color:#D8DEE9FF;">) merge with no-ff</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#EBCB8B;">\\</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> *</span><span style="color:#A3BE8C;"> f52c633</span><span style="color:#D8DEE9FF;"> (dev) add merge</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;">/</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">   cf810e4 conflict fixed</span></span>
<span class="line"><span style="color:#88C0D0;">...</span></span></code></pre></div><p>可以看到，不使用 <code>Fast forward</code> 模式，<code>merge</code> 后就像这样:</p><figure><img src="`+h+'" alt="示例图" tabindex="0" loading="lazy"><figcaption>示例图</figcaption></figure><h3 id="分支管理惯例" tabindex="-1"><a class="header-anchor" href="#分支管理惯例"><span>分支管理惯例</span></a></h3><p>在实际开发中，我们应该按照几个基本原则进行分支管理:</p><p>首先，<code>master</code> 分支应该是非常稳定的，也就是仅用来发布新版本，平时不能在上面干活；</p><p>那在哪干活呢? 干活都在 <code>dev</code> 分支上，也就是说，<code>dev</code> 分支是不稳定的，到某个时候，比如 <code>1.0</code> 版本发布时，再把 <code>dev</code> 分支合并到 <code>master</code> 上，在 <code>master</code> 分支发布 <code>1.0</code> 版本；</p><p>您和您的小伙伴们每个人都在 <code>dev</code> 分支上干活，每个人都有自己的分支，时不时地往 <code>dev</code> 分支上合并就可以了。</p><p>所以，团队合作的分支看起来就像这样:</p>',106)),o(n,{id:"mermaid-300",code:"eJyNUUEOgjAQvPuKhmdww4SACWqCxnspC22klJRi9Pci1bAiFg5NNrMzs5NpKUykacM3hDAlpTD9kGlaM064MoW4vxYc2FV1BiETag43qFSDuQgayETkvkdb7hFDy37KmDfqC6Cm07DFBhizDubRgB/vojjp3xlzJRW1I6hVHo7pPkicGQdeGl7C9BQ6s8wcl6BLmCnNqR0TfDcRLLAXjs3LVyax3sjpHU1DBbQFLELQv1p+F6PIXpp+3jTJh/8EoXrlcg=="}),s[1]||(s[1]=a(`<h3 id="分支管理小结" tabindex="-1"><a class="header-anchor" href="#分支管理小结"><span>分支管理小结</span></a></h3><ul><li><p>Git 分支十分强大，在团队开发中应该充分应用。</p></li><li><p>合并分支时，加上 <code>--no-ff</code> 参数就可以用普通模式合并，合并后的历史有分支，能看出来曾经做过合并，而 <code>fast forward</code> 合并就看不出来曾经做过合并。</p></li></ul><hr><h2 id="bug-分支" tabindex="-1"><a class="header-anchor" href="#bug-分支"><span>Bug 分支</span></a></h2><p>软件开发中，bug 就像家常便饭一样。有了 bug 就需要修复，在 Git 中，由于分支是如此的强大，所以，每个 bug 都可以通过一个新的临时分支来修复，修复后，合并分支，然后将临时分支删除。</p><p>当您接到一个修复一个代号 101 的 bug 的任务时，很自然地，您想创建一个分支 <code>issue-101</code> 来修复它，但是，等等，当前正在 dev 上进行的工作还没有提交:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> status</span></span>
<span class="line"><span style="color:#88C0D0;">On</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Changes</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> be</span><span style="color:#A3BE8C;"> committed:</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git reset HEAD &lt;file&gt;...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> unstage</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">    new</span><span style="color:#A3BE8C;"> file:</span><span style="color:#A3BE8C;">   hello.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">Changes</span><span style="color:#A3BE8C;"> not</span><span style="color:#A3BE8C;"> staged</span><span style="color:#A3BE8C;"> for</span><span style="color:#A3BE8C;"> commit:</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git add &lt;file&gt;...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> update</span><span style="color:#A3BE8C;"> what</span><span style="color:#A3BE8C;"> will</span><span style="color:#A3BE8C;"> be</span><span style="color:#A3BE8C;"> committed</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git checkout -- &lt;file&gt;...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> discard</span><span style="color:#A3BE8C;"> changes</span><span style="color:#A3BE8C;"> in</span><span style="color:#A3BE8C;"> working</span><span style="color:#A3BE8C;"> directory</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">    modified:</span><span style="color:#A3BE8C;">   readme.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>并不是您不想提交，而是工作只进行到一半，还没法提交，预计完成还需 1 天时间。但是，必须在两个小时内修复该 bug，怎么办?</p><p>幸好，Git 还提供了一个 <code>stash</code> 功能，可以把当前工作现场“储藏”起来，等以后恢复现场后继续工作:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> stash</span></span>
<span class="line"><span style="color:#88C0D0;">Saved</span><span style="color:#A3BE8C;"> working</span><span style="color:#A3BE8C;"> directory</span><span style="color:#A3BE8C;"> and</span><span style="color:#A3BE8C;"> index</span><span style="color:#A3BE8C;"> state</span><span style="color:#A3BE8C;"> WIP</span><span style="color:#A3BE8C;"> on</span><span style="color:#A3BE8C;"> dev:</span><span style="color:#A3BE8C;"> f52c633</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> merge</span></span></code></pre></div><p>现在，用 <code>git status</code> 查看工作区，就是干净的(除非有没有被 Git 管理的文件)，因此可以放心地创建分支来修复 bug。</p><p>首先确定要在哪个分支上修复 bug，假定需要在 master 分支上修复，就从 master 创建临时分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> master</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">master</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">Your</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> is</span><span style="color:#A3BE8C;"> ahead</span><span style="color:#A3BE8C;"> of</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">origin/master</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> by</span><span style="color:#B48EAD;"> 6</span><span style="color:#A3BE8C;"> commits.</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git push</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> publish</span><span style="color:#A3BE8C;"> your</span><span style="color:#A3BE8C;"> local</span><span style="color:#A3BE8C;"> commits</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> -b</span><span style="color:#A3BE8C;"> issue-101</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> a</span><span style="color:#A3BE8C;"> new</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">issue-101</span><span style="color:#ECEFF4;">&#39;</span></span></code></pre></div><p>现在修复 bug，需要把“Git is free software ...”改为“Git is a free software ...”，然后提交:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> readme.txt</span></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">fix bug 101</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">issue-101 4c805e2</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;"> fix bug 101</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span><span style="color:#A3BE8C;">,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> deletion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">-</span><span style="color:#ECEFF4;">)</span></span></code></pre></div><p>修复完成后，切换到 <code>master</code> 分支，并完成合并，最后删除 <code>issue-101</code> 分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> master</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">master</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">Your</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> is</span><span style="color:#A3BE8C;"> ahead</span><span style="color:#A3BE8C;"> of</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">origin/master</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> by</span><span style="color:#B48EAD;"> 6</span><span style="color:#A3BE8C;"> commits.</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git push</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> publish</span><span style="color:#A3BE8C;"> your</span><span style="color:#A3BE8C;"> local</span><span style="color:#A3BE8C;"> commits</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> merge</span><span style="color:#A3BE8C;"> --no-ff</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">merged bug fix 101</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> issue-101</span></span>
<span class="line"><span style="color:#88C0D0;">Merge</span><span style="color:#A3BE8C;"> made</span><span style="color:#A3BE8C;"> by</span><span style="color:#A3BE8C;"> the</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">recursive</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> strategy.</span></span>
<span class="line"><span style="color:#88C0D0;"> readme.txt</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 2</span><span style="color:#A3BE8C;"> +-</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span><span style="color:#A3BE8C;">,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> deletion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">-</span><span style="color:#ECEFF4;">)</span></span></code></pre></div><p>太棒了，原计划两个小时的 bug 修复只花了 5 分钟! 现在，是时候接着回到 <code>dev</code> 分支干活了!</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">dev</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> status</span></span>
<span class="line"><span style="color:#88C0D0;">On</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">nothing</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> commit,</span><span style="color:#A3BE8C;"> working</span><span style="color:#A3BE8C;"> tree</span><span style="color:#A3BE8C;"> clean</span></span></code></pre></div><p>工作区是干净的，刚才的工作现场存到哪去了? 用 <code>git stash list</code> 命令看看:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> stash</span><span style="color:#A3BE8C;"> list</span></span>
<span class="line"><span style="color:#88C0D0;">stash@</span><span style="color:#A3BE8C;">{0}</span><span style="color:#88C0D0;">:</span><span style="color:#A3BE8C;"> WIP</span><span style="color:#A3BE8C;"> on</span><span style="color:#A3BE8C;"> dev:</span><span style="color:#A3BE8C;"> f52c633</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> merge</span></span></code></pre></div><p>工作现场还在，Git 把 stash 内容存在某个地方了，但是需要恢复一下，有两个办法:</p><p>一是用 <code>git stash apply</code> 恢复，但是恢复后，<code>stash</code> 内容并不删除，您需要用 <code>git stash drop</code> 来删除；</p><p>另一种方式是用 <code>git stash pop</code>，恢复的同时把 <code>stash</code> 内容也删了:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> stash</span><span style="color:#A3BE8C;"> pop</span></span>
<span class="line"><span style="color:#88C0D0;">On</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Changes</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> be</span><span style="color:#A3BE8C;"> committed:</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git reset HEAD &lt;file&gt;...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> unstage</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">    new</span><span style="color:#A3BE8C;"> file:</span><span style="color:#A3BE8C;">   hello.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">Changes</span><span style="color:#A3BE8C;"> not</span><span style="color:#A3BE8C;"> staged</span><span style="color:#A3BE8C;"> for</span><span style="color:#A3BE8C;"> commit:</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git add &lt;file&gt;...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> update</span><span style="color:#A3BE8C;"> what</span><span style="color:#A3BE8C;"> will</span><span style="color:#A3BE8C;"> be</span><span style="color:#A3BE8C;"> committed</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git checkout -- &lt;file&gt;...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> discard</span><span style="color:#A3BE8C;"> changes</span><span style="color:#A3BE8C;"> in</span><span style="color:#A3BE8C;"> working</span><span style="color:#A3BE8C;"> directory</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">    modified:</span><span style="color:#A3BE8C;">   readme.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">Dropped</span><span style="color:#A3BE8C;"> refs/stash@{</span><span style="color:#B48EAD;">0</span><span style="color:#A3BE8C;">}</span><span style="color:#D8DEE9FF;"> (5d677e2ee266f39ea296182fb2354265b91b3b2a)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再用 <code>git stash list</code> 查看，就看不到任何 stash 内容了。您可以多次 stash，恢复的时候，先用 <code>git stash list</code> 查看，然后恢复指定的 stash，用命令:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> stash</span><span style="color:#A3BE8C;"> apply</span><span style="color:#A3BE8C;"> stash@{</span><span style="color:#B48EAD;">0</span><span style="color:#A3BE8C;">}</span></span></code></pre></div><h3 id="暂存小结" tabindex="-1"><a class="header-anchor" href="#暂存小结"><span>暂存小结</span></a></h3><ul><li><p>修复 bug 时，我们会通过创建新的 bug 分支进行修复，然后合并，最后删除；</p></li><li><p>当手头工作没有完成时，先把工作现场 <code>git stash</code> 一下，然后去修复 bug，修复后，再 <code>git stash pop</code>，回到工作现场。</p></li></ul><hr><h2 id="feature-分支" tabindex="-1"><a class="header-anchor" href="#feature-分支"><span>Feature 分支</span></a></h2><p>软件开发中，总有无穷无尽的新的功能要不断添加进来。</p><p>添加一个新功能时，您肯定不希望因为一些实验性质的代码，把主分支搞乱了，所以，每添加一个新功能，最好新建一个 <code>feature</code> 分支，在上面开发，完成后，合并，最后，删除该 <code>feature</code> 分支。</p><p>现在，您终于接到了一个新任务: 开发代号为 <code>Vulcan</code> 的新功能，该功能计划用于下一代星际飞船。</p><p>于是准备开发:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> -b</span><span style="color:#A3BE8C;"> feature-vulcan</span></span>
<span class="line"><span style="color:#88C0D0;">Switched</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> a</span><span style="color:#A3BE8C;"> new</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">feature-vulcan</span><span style="color:#ECEFF4;">&#39;</span></span></code></pre></div><p>5 分钟后，开发完毕:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> vulcan.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> status</span></span>
<span class="line"><span style="color:#88C0D0;">On</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> feature-vulcan</span></span>
<span class="line"><span style="color:#88C0D0;">Changes</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> be</span><span style="color:#A3BE8C;"> committed:</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git reset HEAD &lt;file&gt;...</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> unstage</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">    new</span><span style="color:#A3BE8C;"> file:</span><span style="color:#A3BE8C;">   vulcan.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">add feature vulcan</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">feature-vulcan 287773e</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;"> add feature vulcan</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 2</span><span style="color:#A3BE8C;"> insertions</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#88C0D0;"> create</span><span style="color:#A3BE8C;"> mode</span><span style="color:#B48EAD;"> 100644</span><span style="color:#A3BE8C;"> vulcan.py</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>切回 <code>dev</code>，准备合并:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> dev</span></span></code></pre></div><p>一切顺利的话，feature 分支和 bug 分支是类似的，合并，然后删除。</p><p>但是!</p><p>就在此时，接到上级命令，因经费不足，新功能必须取消!</p><p>虽然白干了，但是这个包含机密资料的分支还是必须就地销毁:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> -d</span><span style="color:#A3BE8C;"> feature-vulcan</span></span>
<span class="line"><span style="color:#88C0D0;">error:</span><span style="color:#A3BE8C;"> The</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">feature-vulcan</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> is</span><span style="color:#A3BE8C;"> not</span><span style="color:#A3BE8C;"> fully</span><span style="color:#A3BE8C;"> merged.</span></span>
<span class="line"><span style="color:#88C0D0;">If</span><span style="color:#A3BE8C;"> you</span><span style="color:#A3BE8C;"> are</span><span style="color:#A3BE8C;"> sure</span><span style="color:#A3BE8C;"> you</span><span style="color:#A3BE8C;"> want</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> delete</span><span style="color:#A3BE8C;"> it,</span><span style="color:#A3BE8C;"> run</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">git branch -D feature-vulcan</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">.</span></span></code></pre></div><p>销毁失败。Git 友情提醒，feature-vulcan 分支还没有被合并，如果删除，将丢失掉修改，如果要强行删除，需要使用大写的 <code>-D</code> 参数。。</p><p>现在我们强行删除:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> -D</span><span style="color:#A3BE8C;"> feature-vulcan</span></span>
<span class="line"><span style="color:#88C0D0;">Deleted</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> feature-vulcan</span><span style="color:#D8DEE9FF;"> (was </span><span style="color:#A3BE8C;">287773e</span><span style="color:#D8DEE9FF;">).</span></span></code></pre></div><p>终于删除成功!</p><h3 id="删除小结" tabindex="-1"><a class="header-anchor" href="#删除小结"><span>删除小结</span></a></h3><ul><li><p>开发一个新 feature，最好新建一个分支；</p></li><li><p>如果要丢弃一个没有被合并过的分支，可以通过 <code>git branch -D &lt;name&gt;</code> 强行删除。</p></li></ul><hr><h2 id="多人协作" tabindex="-1"><a class="header-anchor" href="#多人协作"><span>多人协作</span></a></h2><p>当您从远程仓库克隆时，实际上 Git 自动把本地的 <code>master</code> 分支和远程的 <code>master</code> 分支对应起来了，并且，远程仓库的默认名称是 <code>origin</code>。</p><p>要查看远程库的信息，用 <code>git remote</code>:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> remote</span></span>
<span class="line"><span style="color:#88C0D0;">origin</span></span></code></pre></div><p>或者，用 <code>git remote -v</code> 显示更详细的信息:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> remote</span><span style="color:#A3BE8C;"> -v</span></span>
<span class="line"><span style="color:#88C0D0;">origin</span><span style="color:#A3BE8C;">  git@github.com:Hope-Studio/learngit.git</span><span style="color:#D8DEE9FF;"> (fetch)</span></span>
<span class="line"><span style="color:#88C0D0;">origin</span><span style="color:#A3BE8C;">  git@github.com:Hope-Studio/learngit.git</span><span style="color:#D8DEE9FF;"> (push)</span></span></code></pre></div><p>上面显示了可以抓取和推送的 <code>origin</code> 的地址。如果没有推送权限，就看不到 push 的地址。</p><h3 id="推送分支" tabindex="-1"><a class="header-anchor" href="#推送分支"><span>推送分支</span></a></h3><p>推送分支，就是把该分支上的所有本地提交推送到远程库。推送时，要指定本地分支，这样，Git 就会把该分支推送到远程库对应的远程分支上:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> push</span><span style="color:#A3BE8C;"> origin</span><span style="color:#A3BE8C;"> master</span></span></code></pre></div><p>如果要推送其他分支，比如 <code>dev</code>，就改成:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> push</span><span style="color:#A3BE8C;"> origin</span><span style="color:#A3BE8C;"> dev</span></span></code></pre></div><p>但是，并不是一定要把本地分支往远程推送，那么，哪些分支需要推送，哪些不需要呢?</p><p><code>master</code> 分支是主分支，因此要时刻与远程同步；</p><p><code>dev</code> 分支是开发分支，团队所有成员都需要在上面工作，所以也需要与远程同步；</p><p><code>bug</code> 分支只用于在本地修复 bug，就没必要推到远程了，除非老板要看看您每周到底修复了几个 bug；</p><p><code>feature</code> 分支是否推到远程，取决于您是否和您的小伙伴合作在上面开发。</p><p>总之，就是在 Git 中，分支完全可以在本地自己藏着玩，是否推送，视您的心情而定!</p><h3 id="抓取分支" tabindex="-1"><a class="header-anchor" href="#抓取分支"><span>抓取分支</span></a></h3><p>多人协作时，大家都会往 <code>master</code> 和 <code>dev</code> 分支上推送各自的修改。</p><p>现在，模拟一个您的小伙伴，可以在另一台电脑 (注意要把 SSH Key 添加到 GitHub) 或者同一台电脑的另一个目录下克隆:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> clone</span><span style="color:#A3BE8C;"> git@github.com:Hope-Studio/learngit.git</span></span>
<span class="line"><span style="color:#88C0D0;">Cloning</span><span style="color:#A3BE8C;"> into</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">learngit</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">...</span></span>
<span class="line"><span style="color:#88C0D0;">remote:</span><span style="color:#A3BE8C;"> Counting</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 40,</span><span style="color:#A3BE8C;"> done.</span></span>
<span class="line"><span style="color:#88C0D0;">remote:</span><span style="color:#A3BE8C;"> Compressing</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (21/21), done.</span></span>
<span class="line"><span style="color:#88C0D0;">remote:</span><span style="color:#A3BE8C;"> Total</span><span style="color:#B48EAD;"> 40</span><span style="color:#D8DEE9FF;"> (delta </span><span style="color:#B48EAD;">14</span><span style="color:#D8DEE9FF;">), reused 40 (</span><span style="color:#88C0D0;">delta</span><span style="color:#B48EAD;"> 14</span><span style="color:#D8DEE9FF;">), pack-reused 0</span></span>
<span class="line"><span style="color:#88C0D0;">Receiving</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (40/40), done.</span></span>
<span class="line"><span style="color:#88C0D0;">Resolving</span><span style="color:#A3BE8C;"> deltas:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (14/14), done.</span></span></code></pre></div><p>当您的小伙伴从远程库 clone 时，默认情况下，您的小伙伴只能看到本地的 <code>master</code> 分支。不信可以用 <code>git branch</code> 命令看看:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> branch</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> master</span></span></code></pre></div><p>现在，您的小伙伴要在 <code>dev</code> 分支上开发，就必须创建远程 <code>origin</code> 的 <code>dev</code> 分支到本地，于是他用这个命令创建本地 <code>dev</code> 分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> checkout</span><span style="color:#A3BE8C;"> -b</span><span style="color:#A3BE8C;"> dev</span><span style="color:#A3BE8C;"> origin/dev</span></span></code></pre></div><p>现在，他就可以在 <code>dev</code> 上继续修改，然后，时不时地把 <code>dev</code> 分支 push 到远程:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> env.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">add env</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">dev 7a5e5dd</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;"> add env</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#88C0D0;"> create</span><span style="color:#A3BE8C;"> mode</span><span style="color:#B48EAD;"> 100644</span><span style="color:#A3BE8C;"> env.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> push</span><span style="color:#A3BE8C;"> origin</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Counting</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 3,</span><span style="color:#A3BE8C;"> done.</span></span>
<span class="line"><span style="color:#88C0D0;">Delta</span><span style="color:#A3BE8C;"> compression</span><span style="color:#A3BE8C;"> using</span><span style="color:#A3BE8C;"> up</span><span style="color:#A3BE8C;"> to</span><span style="color:#B48EAD;"> 4</span><span style="color:#A3BE8C;"> threads.</span></span>
<span class="line"><span style="color:#88C0D0;">Compressing</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (2/2), done.</span></span>
<span class="line"><span style="color:#88C0D0;">Writing</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (3/3), 308 bytes </span><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> 308.00</span><span style="color:#A3BE8C;"> KiB/s,</span><span style="color:#A3BE8C;"> done.</span></span>
<span class="line"><span style="color:#88C0D0;">Total</span><span style="color:#B48EAD;"> 3</span><span style="color:#D8DEE9FF;"> (delta </span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">), reused 0 (</span><span style="color:#88C0D0;">delta</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#88C0D0;">To</span><span style="color:#A3BE8C;"> github.com:Hope-Studio/learngit.git</span></span>
<span class="line"><span style="color:#88C0D0;">   f52c633..7a5e5dd</span><span style="color:#A3BE8C;">  dev</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> dev</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>您的小伙伴已经向 <code>origin/dev</code> 分支推送了他的提交，想要获取他的工作，您可以执行 <code>git fetch origin dev</code>。</p><p>如果这时碰巧您也对同样的文件作了修改，并试图推送:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> cat</span><span style="color:#A3BE8C;"> env.txt</span></span>
<span class="line"><span style="color:#88C0D0;">env</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">git</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> env.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">add new env</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">dev 7bd91f1</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;"> add new env</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"><span style="color:#88C0D0;"> create</span><span style="color:#A3BE8C;"> mode</span><span style="color:#B48EAD;"> 100644</span><span style="color:#A3BE8C;"> env.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> push</span><span style="color:#A3BE8C;"> origin</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">To</span><span style="color:#A3BE8C;"> github.com:Hope-Studio/learngit.git</span></span>
<span class="line"><span style="color:#81A1C1;"> !</span><span style="color:#ECEFF4;"> [</span><span style="color:#D8DEE9FF;">rejected</span><span style="color:#ECEFF4;">]</span><span style="color:#88C0D0;">        dev</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> dev</span><span style="color:#D8DEE9FF;"> (non-fast-forward)</span></span>
<span class="line"><span style="color:#88C0D0;">error:</span><span style="color:#A3BE8C;"> failed</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> push</span><span style="color:#A3BE8C;"> some</span><span style="color:#A3BE8C;"> refs</span><span style="color:#A3BE8C;"> to</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">git@github.com:Hope-Studio/learngit.git</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">hint:</span><span style="color:#A3BE8C;"> Updates</span><span style="color:#A3BE8C;"> were</span><span style="color:#A3BE8C;"> rejected</span><span style="color:#A3BE8C;"> because</span><span style="color:#A3BE8C;"> the</span><span style="color:#A3BE8C;"> tip</span><span style="color:#A3BE8C;"> of</span><span style="color:#A3BE8C;"> your</span><span style="color:#A3BE8C;"> current</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> is</span><span style="color:#A3BE8C;"> behind</span></span>
<span class="line"><span style="color:#88C0D0;">hint:</span><span style="color:#A3BE8C;"> its</span><span style="color:#A3BE8C;"> remote</span><span style="color:#A3BE8C;"> counterpart.</span><span style="color:#A3BE8C;"> Integrate</span><span style="color:#A3BE8C;"> the</span><span style="color:#A3BE8C;"> remote</span><span style="color:#A3BE8C;"> changes</span><span style="color:#D8DEE9FF;"> (e.g.</span></span>
<span class="line"><span style="color:#88C0D0;">hint:</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">git pull ...</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">) before pushing again.</span></span>
<span class="line"><span style="color:#88C0D0;">hint:</span><span style="color:#A3BE8C;"> See</span><span style="color:#A3BE8C;"> the</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">Note about fast-forwards</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> in</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">git push --help</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> for</span><span style="color:#A3BE8C;"> details.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>推送失败，因为您的小伙伴的最新提交和您试图推送的提交有冲突，解决办法也很简单，Git 已经提示我们，先用 <code>git pull</code> 把最新的提交从 <code>origin/dev</code> 抓下来，然后，在本地合并，解决冲突，再推送:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> pull</span></span>
<span class="line"><span style="color:#88C0D0;">There</span><span style="color:#A3BE8C;"> is</span><span style="color:#A3BE8C;"> no</span><span style="color:#A3BE8C;"> tracking</span><span style="color:#A3BE8C;"> information</span><span style="color:#A3BE8C;"> for</span><span style="color:#A3BE8C;"> the</span><span style="color:#A3BE8C;"> current</span><span style="color:#A3BE8C;"> branch.</span></span>
<span class="line"><span style="color:#88C0D0;">Please</span><span style="color:#A3BE8C;"> specify</span><span style="color:#A3BE8C;"> which</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> you</span><span style="color:#A3BE8C;"> want</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> merge</span><span style="color:#A3BE8C;"> with.</span></span>
<span class="line"><span style="color:#88C0D0;">See</span><span style="color:#A3BE8C;"> git-pull</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">1</span><span style="color:#ECEFF4;">)</span><span style="color:#A3BE8C;"> for</span><span style="color:#A3BE8C;"> details.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">    git</span><span style="color:#A3BE8C;"> pull</span><span style="color:#81A1C1;"> &lt;</span><span style="color:#A3BE8C;">remot</span><span style="color:#D8DEE9FF;">e</span><span style="color:#81A1C1;">&gt;</span><span style="color:#81A1C1;"> &lt;</span><span style="color:#A3BE8C;">branc</span><span style="color:#D8DEE9FF;">h</span><span style="color:#81A1C1;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">If</span><span style="color:#A3BE8C;"> you</span><span style="color:#A3BE8C;"> wish</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> set</span><span style="color:#A3BE8C;"> tracking</span><span style="color:#A3BE8C;"> information</span><span style="color:#A3BE8C;"> for</span><span style="color:#A3BE8C;"> this</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> you</span><span style="color:#A3BE8C;"> can</span><span style="color:#A3BE8C;"> do</span><span style="color:#A3BE8C;"> so</span><span style="color:#A3BE8C;"> with:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">    git</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> --set-upstream-to=origin/</span><span style="color:#81A1C1;">&lt;</span><span style="color:#A3BE8C;">branch</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> dev</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>git pull</code> 也失败了，原因是没有指定本地 <code>dev</code> 分支与远程 <code>origin/dev</code> 分支的链接，根据提示，设置 <code>dev</code> 和 <code>origin/dev</code> 的链接:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> --set-upstream-to=origin/dev</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">dev</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> set</span><span style="color:#A3BE8C;"> up</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> track</span><span style="color:#A3BE8C;"> remote</span><span style="color:#A3BE8C;"> branch</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">dev</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> from</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">origin</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">.</span></span></code></pre></div><p>再 pull:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> pull</span></span>
<span class="line"><span style="color:#88C0D0;">Auto-merging</span><span style="color:#A3BE8C;"> env.txt</span></span>
<span class="line"><span style="color:#88C0D0;">CONFLICT</span><span style="color:#D8DEE9FF;"> (add/add): Merge conflict in env.txt</span></span>
<span class="line"><span style="color:#88C0D0;">Automatic</span><span style="color:#A3BE8C;"> merge</span><span style="color:#A3BE8C;"> failed</span><span style="color:#81A1C1;">;</span><span style="color:#88C0D0;"> fix</span><span style="color:#A3BE8C;"> conflicts</span><span style="color:#A3BE8C;"> and</span><span style="color:#A3BE8C;"> then</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> the</span><span style="color:#A3BE8C;"> result.</span></span></code></pre></div><p>这回 <code>git pull</code> 成功，但是合并有冲突，需要手动解决，解决的方法和分支管理中的解决冲突完全一样。解决后，提交，再 push:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> commit</span><span style="color:#A3BE8C;"> -m</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">fix env conflict</span><span style="color:#ECEFF4;">&quot;</span></span>
<span class="line"><span style="color:#ECEFF4;">[</span><span style="color:#D8DEE9FF;">dev 57c53ab</span><span style="color:#ECEFF4;">]</span><span style="color:#D8DEE9FF;"> fix env conflict</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> push</span><span style="color:#A3BE8C;"> origin</span><span style="color:#A3BE8C;"> dev</span></span>
<span class="line"><span style="color:#88C0D0;">Counting</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 6,</span><span style="color:#A3BE8C;"> done.</span></span>
<span class="line"><span style="color:#88C0D0;">Delta</span><span style="color:#A3BE8C;"> compression</span><span style="color:#A3BE8C;"> using</span><span style="color:#A3BE8C;"> up</span><span style="color:#A3BE8C;"> to</span><span style="color:#B48EAD;"> 4</span><span style="color:#A3BE8C;"> threads.</span></span>
<span class="line"><span style="color:#88C0D0;">Compressing</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (4/4), done.</span></span>
<span class="line"><span style="color:#88C0D0;">Writing</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (6/6), 621 bytes </span><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> 621.00</span><span style="color:#A3BE8C;"> KiB/s,</span><span style="color:#A3BE8C;"> done.</span></span>
<span class="line"><span style="color:#88C0D0;">Total</span><span style="color:#B48EAD;"> 6</span><span style="color:#D8DEE9FF;"> (delta </span><span style="color:#B48EAD;">0</span><span style="color:#D8DEE9FF;">), reused 0 (</span><span style="color:#88C0D0;">delta</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#88C0D0;">To</span><span style="color:#A3BE8C;"> github.com:Hope-Studio/learngit.git</span></span>
<span class="line"><span style="color:#88C0D0;">   7a5e5dd..57c53ab</span><span style="color:#A3BE8C;">  dev</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> dev</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因此，多人协作的工作模式通常是这样:</p><p>首先，可以试图用 <code>git push origin &lt;branch-name&gt;</code> 推送自己的修改；</p><p>如果推送失败，则因为远程分支比您的本地更新，需要先用 <code>git pull</code> 试图合并；</p><p>如果合并有冲突，则解决冲突，并在本地提交；</p><p>没有冲突或者解决掉冲突后，再用 <code>git push origin &lt;branch-name&gt;</code> 推送就能成功!</p><p>如果 <code>git pull</code> 提示 <code>no tracking information</code>，则说明本地分支和远程分支的链接关系没有创建，用命令 <code>git branch --set-upstream-to &lt;branch-name&gt; origin/&lt;branch-name&gt;</code>。</p><p>这就是多人协作的工作模式，一旦熟悉了，就非常简单。</p><h3 id="多人协作小结" tabindex="-1"><a class="header-anchor" href="#多人协作小结"><span>多人协作小结</span></a></h3><ul><li><p>查看远程库信息，使用 <code>git remote -v</code>；</p></li><li><p>本地新建的分支如果不推送到远程，对其他人就是不可见的；</p></li><li><p>从本地推送分支，使用 <code>git push origin branch-name</code>，如果推送失败，先用 <code>git pull</code> 抓取远程的新提交；</p></li><li><p>在本地创建和远程分支对应的分支，使用 <code>git checkout -b branch-name origin/branch-name</code>，本地和远程分支的名称最好一致；</p></li><li><p>建立本地分支和远程分支的关联，使用 <code>git branch --set-upstream branch-name origin/branch-name</code>；</p></li><li><p>从远程拉取分支，使用 <code>git fetch</code>。</p></li><li><p><code>git pull</code>，相当于 <code>git fetch</code> + <code>git merge</code>，如果您的修改并没有和远程的修改发生冲突，两者会自动合并到您的本地，您可以直接推送上去。如果有冲突，要先处理冲突。</p></li></ul><hr><h2 id="rebase" tabindex="-1"><a class="header-anchor" href="#rebase"><span>Rebase</span></a></h2><p>在上一节我们看到了，多人在同一个分支上协作时，很容易出现冲突。即使没有冲突，后 <code>push</code> 的童鞋不得不先 <code>pull</code>，在本地合并，然后才能 <code>push</code> 成功。</p><p>每次合并再 <code>push</code> 后，分支变成了这样:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> log</span><span style="color:#A3BE8C;"> --graph</span><span style="color:#A3BE8C;"> --pretty=oneline</span><span style="color:#A3BE8C;"> --abbrev-commit</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> d1be385 (</span><span style="color:#88C0D0;">HEAD</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> master,</span><span style="color:#A3BE8C;"> origin/master</span><span style="color:#D8DEE9FF;">) init hello</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">   e5e69f1 Merge branch </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">dev</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#EBCB8B;">\\</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> *</span><span style="color:#A3BE8C;">   57c53ab</span><span style="color:#D8DEE9FF;"> (origin/dev, </span><span style="color:#A3BE8C;">dev</span><span style="color:#D8DEE9FF;">) fix env conflict</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#81A1C1;"> |</span><span style="color:#EBCB8B;">\\</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> *</span><span style="color:#A3BE8C;"> 7a5e5dd</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> env</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> *</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 7bd91f1</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> new</span><span style="color:#A3BE8C;"> env</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;">/</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;">   12a631b</span><span style="color:#A3BE8C;"> merged</span><span style="color:#A3BE8C;"> bug</span><span style="color:#A3BE8C;"> fix</span><span style="color:#B48EAD;"> 101</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;">\\</span><span style="color:#EBCB8B;"> \\</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> *</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 4c805e2</span><span style="color:#A3BE8C;"> fix</span><span style="color:#A3BE8C;"> bug</span><span style="color:#B48EAD;"> 101</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;">/</span><span style="color:#A3BE8C;"> /</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;">   e1e9c68</span><span style="color:#A3BE8C;"> merge</span><span style="color:#A3BE8C;"> with</span><span style="color:#A3BE8C;"> no-ff</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;">\\</span><span style="color:#EBCB8B;"> \\</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;">/</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> *</span><span style="color:#A3BE8C;"> f52c633</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> merge</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;">/</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">   cf810e4 conflict fixed</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>总之看上去很乱，有强迫症的童鞋会问: 为什么 Git 的提交历史不能是一条干净的直线? 其实是可以做到的!</p><p>Git 有一种称为 <code>rebase</code> 的操作，有人把它翻译成“变基”。</p><p>先不要随意展开想象。我们还是从实际问题出发，看看怎么把分叉的提交变成直线。</p><p>在和远程分支同步后，我们对 <code>hello.py</code> 这个文件做了两次提交。用 <code>git log</code> 命令看看:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> log</span><span style="color:#A3BE8C;"> --graph</span><span style="color:#A3BE8C;"> --pretty=oneline</span><span style="color:#A3BE8C;"> --abbrev-commit</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> 582d922 (</span><span style="color:#88C0D0;">HEAD</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> master</span><span style="color:#D8DEE9FF;">) add author</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> 8875536 add comment</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> d1be385 (</span><span style="color:#88C0D0;">origin/master</span><span style="color:#D8DEE9FF;">) init hello</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">   e5e69f1 Merge branch </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">dev</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#EBCB8B;">\\</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> *</span><span style="color:#A3BE8C;">   57c53ab</span><span style="color:#D8DEE9FF;"> (origin/dev, </span><span style="color:#A3BE8C;">dev</span><span style="color:#D8DEE9FF;">) fix env conflict</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#81A1C1;"> |</span><span style="color:#EBCB8B;">\\</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> *</span><span style="color:#A3BE8C;"> 7a5e5dd</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> env</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> *</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 7bd91f1</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> new</span><span style="color:#A3BE8C;"> env</span></span>
<span class="line"><span style="color:#88C0D0;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意到 Git 用 <code>(HEAD -&gt; master)</code> 和 <code>(origin/master)</code> 标识出当前分支的 <code>HEAD</code> 和远程 <code>origin</code> 的位置分别是 <code>582d922 add author</code> 和 <code>d1be385 init hello</code>，本地分支比远程分支快两个提交。</p><p>现在我们尝试推送本地分支:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> push</span><span style="color:#A3BE8C;"> origin</span><span style="color:#A3BE8C;"> master</span></span>
<span class="line"><span style="color:#88C0D0;">To</span><span style="color:#A3BE8C;"> github.com:Hope-Studio/learngit.git</span></span>
<span class="line"><span style="color:#81A1C1;"> !</span><span style="color:#ECEFF4;"> [</span><span style="color:#D8DEE9FF;">rejected</span><span style="color:#ECEFF4;">]</span><span style="color:#88C0D0;">        master</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> master</span><span style="color:#D8DEE9FF;"> (fetch </span><span style="color:#A3BE8C;">first</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#88C0D0;">error:</span><span style="color:#A3BE8C;"> failed</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> push</span><span style="color:#A3BE8C;"> some</span><span style="color:#A3BE8C;"> refs</span><span style="color:#A3BE8C;"> to</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">git@github.com:Hope-Studio/learngit.git</span><span style="color:#ECEFF4;">&#39;</span></span>
<span class="line"><span style="color:#88C0D0;">hint:</span><span style="color:#A3BE8C;"> Updates</span><span style="color:#A3BE8C;"> were</span><span style="color:#A3BE8C;"> rejected</span><span style="color:#A3BE8C;"> because</span><span style="color:#A3BE8C;"> the</span><span style="color:#A3BE8C;"> remote</span><span style="color:#A3BE8C;"> contains</span><span style="color:#A3BE8C;"> work</span><span style="color:#A3BE8C;"> that</span><span style="color:#A3BE8C;"> you</span><span style="color:#A3BE8C;"> do</span></span>
<span class="line"><span style="color:#88C0D0;">hint:</span><span style="color:#A3BE8C;"> not</span><span style="color:#A3BE8C;"> have</span><span style="color:#A3BE8C;"> locally.</span><span style="color:#A3BE8C;"> This</span><span style="color:#A3BE8C;"> is</span><span style="color:#A3BE8C;"> usually</span><span style="color:#A3BE8C;"> caused</span><span style="color:#A3BE8C;"> by</span><span style="color:#A3BE8C;"> another</span><span style="color:#A3BE8C;"> repository</span><span style="color:#A3BE8C;"> pushing</span></span>
<span class="line"><span style="color:#88C0D0;">hint:</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> the</span><span style="color:#A3BE8C;"> same</span><span style="color:#A3BE8C;"> ref.</span><span style="color:#A3BE8C;"> You</span><span style="color:#A3BE8C;"> may</span><span style="color:#A3BE8C;"> want</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> first</span><span style="color:#A3BE8C;"> integrate</span><span style="color:#A3BE8C;"> the</span><span style="color:#A3BE8C;"> remote</span><span style="color:#A3BE8C;"> changes</span></span>
<span class="line"><span style="color:#88C0D0;">hint:</span><span style="color:#D8DEE9FF;"> (e.g., </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">git pull ...</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;">) before pushing again.</span></span>
<span class="line"><span style="color:#88C0D0;">hint:</span><span style="color:#A3BE8C;"> See</span><span style="color:#A3BE8C;"> the</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">Note about fast-forwards</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> in</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">git push --help</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> for</span><span style="color:#A3BE8C;"> details.</span></span></code></pre></div><p>很不幸，失败了，这说明有人先于我们推送了远程分支。按照经验，先 pull 一下:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> pull</span></span>
<span class="line"><span style="color:#88C0D0;">remote:</span><span style="color:#A3BE8C;"> Counting</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 3,</span><span style="color:#A3BE8C;"> done.</span></span>
<span class="line"><span style="color:#88C0D0;">remote:</span><span style="color:#A3BE8C;"> Compressing</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (1/1), done.</span></span>
<span class="line"><span style="color:#88C0D0;">remote:</span><span style="color:#A3BE8C;"> Total</span><span style="color:#B48EAD;"> 3</span><span style="color:#D8DEE9FF;"> (delta </span><span style="color:#B48EAD;">1</span><span style="color:#D8DEE9FF;">), reused 3 (</span><span style="color:#88C0D0;">delta</span><span style="color:#B48EAD;"> 1</span><span style="color:#D8DEE9FF;">), pack-reused 0</span></span>
<span class="line"><span style="color:#88C0D0;">Unpacking</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (3/3), done.</span></span>
<span class="line"><span style="color:#88C0D0;">From</span><span style="color:#A3BE8C;"> github.com:Hope-Studio/learngit</span></span>
<span class="line"><span style="color:#88C0D0;">   d1be385..f005ed4</span><span style="color:#A3BE8C;">  master</span><span style="color:#D8DEE9FF;">     -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> origin/master</span></span>
<span class="line"><span style="color:#88C0D0;"> *</span><span style="color:#D8DEE9FF;"> [new </span><span style="color:#A3BE8C;">tag]</span><span style="color:#A3BE8C;">         v1.0</span><span style="color:#D8DEE9FF;">       -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> v1.0</span></span>
<span class="line"><span style="color:#88C0D0;">Auto-merging</span><span style="color:#A3BE8C;"> hello.py</span></span>
<span class="line"><span style="color:#88C0D0;">Merge</span><span style="color:#A3BE8C;"> made</span><span style="color:#A3BE8C;"> by</span><span style="color:#A3BE8C;"> the</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">recursive</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> strategy.</span></span>
<span class="line"><span style="color:#88C0D0;"> hello.py</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> +</span></span>
<span class="line"><span style="color:#88C0D0;"> 1</span><span style="color:#A3BE8C;"> file</span><span style="color:#A3BE8C;"> changed,</span><span style="color:#B48EAD;"> 1</span><span style="color:#A3BE8C;"> insertion</span><span style="color:#ECEFF4;">(</span><span style="color:#88C0D0;">+</span><span style="color:#ECEFF4;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>再用 <code>git status</code> 看看状态:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> status</span></span>
<span class="line"><span style="color:#88C0D0;">On</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> master</span></span>
<span class="line"><span style="color:#88C0D0;">Your</span><span style="color:#A3BE8C;"> branch</span><span style="color:#A3BE8C;"> is</span><span style="color:#A3BE8C;"> ahead</span><span style="color:#A3BE8C;"> of</span><span style="color:#ECEFF4;"> &#39;</span><span style="color:#A3BE8C;">origin/master</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;"> by</span><span style="color:#B48EAD;"> 3</span><span style="color:#A3BE8C;"> commits.</span></span>
<span class="line"><span style="color:#ECEFF4;">  (</span><span style="color:#88C0D0;">use</span><span style="color:#ECEFF4;"> &quot;</span><span style="color:#A3BE8C;">git push</span><span style="color:#ECEFF4;">&quot;</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> publish</span><span style="color:#A3BE8C;"> your</span><span style="color:#A3BE8C;"> local</span><span style="color:#A3BE8C;"> commits</span><span style="color:#ECEFF4;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88C0D0;">nothing</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> commit,</span><span style="color:#A3BE8C;"> working</span><span style="color:#A3BE8C;"> tree</span><span style="color:#A3BE8C;"> clean</span></span></code></pre></div><p>加上刚才合并的提交，现在我们本地分支比远程分支超前 3 个提交。</p><p>用 <code>git log</code> 看看:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> log</span><span style="color:#A3BE8C;"> --graph</span><span style="color:#A3BE8C;"> --pretty=oneline</span><span style="color:#A3BE8C;"> --abbrev-commit</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;">   e0ea545 (</span><span style="color:#88C0D0;">HEAD</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> master</span><span style="color:#D8DEE9FF;">) Merge branch </span><span style="color:#ECEFF4;">&#39;</span><span style="color:#A3BE8C;">master</span><span style="color:#ECEFF4;">&#39;</span><span style="color:#D8DEE9FF;"> of github.com:Hope-Studio/learngit</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#EBCB8B;">\\</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> *</span><span style="color:#A3BE8C;"> f005ed4</span><span style="color:#D8DEE9FF;"> (origin/master) set </span><span style="color:#D8DEE9;">exit</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">1</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 582d922</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> author</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#81A1C1;"> |</span><span style="color:#88C0D0;"> 8875536</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> comment</span></span>
<span class="line"><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;">/</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> d1be385 init hello</span></span>
<span class="line"><span style="color:#88C0D0;">...</span></span></code></pre></div><p>对强迫症童鞋来说，现在事情有点不对头，提交历史分叉了。如果现在把本地分支 <code>push</code> 到远程，有没有问题?</p><p>有!</p><p>什么问题?</p><p>不好看!</p><p>有没有解决方法?</p><p>有!</p><p>这个时候，rebase 就派上了用场。我们输入命令 <code>git rebase</code> 试试:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> rebase</span></span>
<span class="line"><span style="color:#88C0D0;">First,</span><span style="color:#A3BE8C;"> rewinding</span><span style="color:#A3BE8C;"> head</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> replay</span><span style="color:#A3BE8C;"> your</span><span style="color:#A3BE8C;"> work</span><span style="color:#A3BE8C;"> on</span><span style="color:#A3BE8C;"> top</span><span style="color:#A3BE8C;"> of</span><span style="color:#A3BE8C;"> it...</span></span>
<span class="line"><span style="color:#88C0D0;">Applying:</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> comment</span></span>
<span class="line"><span style="color:#88C0D0;">Using</span><span style="color:#A3BE8C;"> index</span><span style="color:#A3BE8C;"> info</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> reconstruct</span><span style="color:#A3BE8C;"> a</span><span style="color:#A3BE8C;"> base</span><span style="color:#A3BE8C;"> tree...</span></span>
<span class="line"><span style="color:#88C0D0;">M</span><span style="color:#A3BE8C;">    hello.py</span></span>
<span class="line"><span style="color:#88C0D0;">Falling</span><span style="color:#A3BE8C;"> back</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> patching</span><span style="color:#A3BE8C;"> base</span><span style="color:#A3BE8C;"> and</span><span style="color:#A3BE8C;"> 3-way</span><span style="color:#A3BE8C;"> merge...</span></span>
<span class="line"><span style="color:#88C0D0;">Auto-merging</span><span style="color:#A3BE8C;"> hello.py</span></span>
<span class="line"><span style="color:#88C0D0;">Applying:</span><span style="color:#A3BE8C;"> add</span><span style="color:#A3BE8C;"> author</span></span>
<span class="line"><span style="color:#88C0D0;">Using</span><span style="color:#A3BE8C;"> index</span><span style="color:#A3BE8C;"> info</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> reconstruct</span><span style="color:#A3BE8C;"> a</span><span style="color:#A3BE8C;"> base</span><span style="color:#A3BE8C;"> tree...</span></span>
<span class="line"><span style="color:#88C0D0;">M</span><span style="color:#A3BE8C;">    hello.py</span></span>
<span class="line"><span style="color:#88C0D0;">Falling</span><span style="color:#A3BE8C;"> back</span><span style="color:#A3BE8C;"> to</span><span style="color:#A3BE8C;"> patching</span><span style="color:#A3BE8C;"> base</span><span style="color:#A3BE8C;"> and</span><span style="color:#A3BE8C;"> 3-way</span><span style="color:#A3BE8C;"> merge...</span></span>
<span class="line"><span style="color:#88C0D0;">Auto-merging</span><span style="color:#A3BE8C;"> hello.py</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出了一大堆操作，到底是啥效果? 再用 <code>git log</code> 看看:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> log</span><span style="color:#A3BE8C;"> --graph</span><span style="color:#A3BE8C;"> --pretty=oneline</span><span style="color:#A3BE8C;"> --abbrev-commit</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> 7e61ed4 (</span><span style="color:#88C0D0;">HEAD</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> master</span><span style="color:#D8DEE9FF;">) add author</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> 3611cfe add comment</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> f005ed4 (</span><span style="color:#88C0D0;">origin/master</span><span style="color:#D8DEE9FF;">) set </span><span style="color:#D8DEE9;">exit</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">1</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> d1be385 init hello</span></span>
<span class="line"><span style="color:#88C0D0;">...</span></span></code></pre></div><p>原本分叉的提交现在变成一条直线了! 这种神奇的操作是怎么实现的? 其实原理非常简单。我们注意观察，发现 Git 把我们本地的提交“挪动”了位置，放到了 <code>f005ed4 (origin/master) set exit=1</code> 之后，这样，整个提交历史就成了一条直线。<code>rebase</code> 操作前后，最终的提交内容是一致的，但是，我们本地的 commit 修改内容已经变化了，它们的修改不再基于 <code>d1be385 init hello</code>，而是基于 <code>f005ed4 (origin/master) set exit=1</code>，但最后的提交 <code>7e61ed4</code> 内容是一致的。</p><p>这就是 <code>rebase</code> 操作的特点: 把分叉的提交历史“整理”成一条直线，看上去更直观。缺点是本地的分叉提交已经被修改过了。</p><p>最后，通过 <code>push</code> 操作把本地分支推送到远程:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">Mac:~/learngit</span><span style="color:#A3BE8C;"> michael</span><span style="color:#D8DEE9FF;">$ </span><span style="color:#A3BE8C;">git</span><span style="color:#A3BE8C;"> push</span><span style="color:#A3BE8C;"> origin</span><span style="color:#A3BE8C;"> master</span></span>
<span class="line"><span style="color:#88C0D0;">Counting</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 6,</span><span style="color:#A3BE8C;"> done.</span></span>
<span class="line"><span style="color:#88C0D0;">Delta</span><span style="color:#A3BE8C;"> compression</span><span style="color:#A3BE8C;"> using</span><span style="color:#A3BE8C;"> up</span><span style="color:#A3BE8C;"> to</span><span style="color:#B48EAD;"> 4</span><span style="color:#A3BE8C;"> threads.</span></span>
<span class="line"><span style="color:#88C0D0;">Compressing</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (5/5), done.</span></span>
<span class="line"><span style="color:#88C0D0;">Writing</span><span style="color:#A3BE8C;"> objects:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (6/6), 576 bytes </span><span style="color:#81A1C1;">|</span><span style="color:#88C0D0;"> 576.00</span><span style="color:#A3BE8C;"> KiB/s,</span><span style="color:#A3BE8C;"> done.</span></span>
<span class="line"><span style="color:#88C0D0;">Total</span><span style="color:#B48EAD;"> 6</span><span style="color:#D8DEE9FF;"> (delta </span><span style="color:#B48EAD;">2</span><span style="color:#D8DEE9FF;">), reused 0 (</span><span style="color:#88C0D0;">delta</span><span style="color:#B48EAD;"> 0</span><span style="color:#D8DEE9FF;">)</span></span>
<span class="line"><span style="color:#88C0D0;">remote:</span><span style="color:#A3BE8C;"> Resolving</span><span style="color:#A3BE8C;"> deltas:</span><span style="color:#A3BE8C;"> 100%</span><span style="color:#D8DEE9FF;"> (2/2), completed with 1 </span><span style="color:#81A1C1;">local</span><span style="color:#D8DEE9;"> object</span><span style="color:#D8DEE9FF;">.</span></span>
<span class="line"><span style="color:#88C0D0;">To</span><span style="color:#A3BE8C;"> github.com:Hope-Studio/learngit.git</span></span>
<span class="line"><span style="color:#88C0D0;">   f005ed4..7e61ed4</span><span style="color:#A3BE8C;">  master</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> master</span></span></code></pre></div><p>再用 <code>git log</code> 看看效果:</p><div class="language-sh" data-highlighter="shiki" data-ext="sh" data-title="sh" style="background-color:#2e3440ff;color:#d8dee9ff;"><pre class="shiki nord vp-code"><code><span class="line"><span style="color:#88C0D0;">$</span><span style="color:#A3BE8C;"> git</span><span style="color:#A3BE8C;"> log</span><span style="color:#A3BE8C;"> --graph</span><span style="color:#A3BE8C;"> --pretty=oneline</span><span style="color:#A3BE8C;"> --abbrev-commit</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> 7e61ed4 (</span><span style="color:#88C0D0;">HEAD</span><span style="color:#D8DEE9FF;"> -</span><span style="color:#81A1C1;">&gt;</span><span style="color:#A3BE8C;"> master,</span><span style="color:#A3BE8C;"> origin/master</span><span style="color:#D8DEE9FF;">) add author</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> 3611cfe add comment</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> f005ed4 set </span><span style="color:#D8DEE9;">exit</span><span style="color:#81A1C1;">=</span><span style="color:#A3BE8C;">1</span></span>
<span class="line"><span style="color:#81A1C1;">*</span><span style="color:#D8DEE9FF;"> d1be385 init hello</span></span>
<span class="line"><span style="color:#88C0D0;">...</span></span></code></pre></div><p>远程分支的提交历史也是一条直线。</p><h2 id="rebase-小结" tabindex="-1"><a class="header-anchor" href="#rebase-小结"><span>Rebase 小结</span></a></h2><ul><li><p><code>rebase</code> 操作可以把本地未 <code>push</code> 的分叉提交历史整理成直线；</p></li><li><p><code>rebase</code> 的目的是使得我们在查看历史提交的变化时更容易，因为分叉的提交需要三方对比。</p></li></ul>`,139))])}const m=l(g,[["render",u],["__file","branch.html.vue"]]),b=JSON.parse('{"path":"/software/git/branch.html","title":"分支管理","lang":"zh-CN","frontmatter":{"date":"2020-05-04T00:00:00.000Z","title":"分支管理","icon":"branch","order":10,"author":"廖雪峰","category":"Git","tag":["Git","软件"],"copyright":"Copyright by 廖雪峰 Edited by Mr.Hope","description":"概述 分支就是科幻电影里面的平行宇宙，当您正在电脑前努力学习 Git 的时候，另一个您正在另一个平行宇宙里努力学习 SVN。 如果两个平行宇宙互不干扰，那对现在的您也没啥影响。不过，在某个时间点，两个平行宇宙合并了，结果，您既学会了 Git 又学会了 SVN! Learn branchesLearn branches 分支在实际中有什么用呢? 假设您准...","head":[["meta",{"property":"og:url","content":"https://mister-hope.com/software/git/branch.html"}],["meta",{"property":"og:site_name","content":"Mr.Hope"}],["meta",{"property":"og:title","content":"分支管理"}],["meta",{"property":"og:description","content":"概述 分支就是科幻电影里面的平行宇宙，当您正在电脑前努力学习 Git 的时候，另一个您正在另一个平行宇宙里努力学习 SVN。 如果两个平行宇宙互不干扰，那对现在的您也没啥影响。不过，在某个时间点，两个平行宇宙合并了，结果，您既学会了 Git 又学会了 SVN! Learn branchesLearn branches 分支在实际中有什么用呢? 假设您准..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-01-25T17:47:26.000Z"}],["meta",{"property":"article:author","content":"廖雪峰"}],["meta",{"property":"article:tag","content":"Git"}],["meta",{"property":"article:tag","content":"软件"}],["meta",{"property":"article:published_time","content":"2020-05-04T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-01-25T17:47:26.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"分支管理\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2020-05-04T00:00:00.000Z\\",\\"dateModified\\":\\"2024-01-25T17:47:26.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"廖雪峰\\"}]}"],["link",{"rel":"alternate","type":"application/atom+xml","href":"https://mister-hope.com/atom.xml","title":"Mr.Hope Atom Feed"}],["link",{"rel":"alternate","type":"application/json","href":"https://mister-hope.com/feed.json","title":"Mr.Hope JSON Feed"}],["link",{"rel":"alternate","type":"application/rss+xml","href":"https://mister-hope.com/rss.xml","title":"Mr.Hope RSS Feed"}]]},"headers":[{"level":2,"title":"概述","slug":"概述","link":"#概述","children":[]},{"level":2,"title":"创建与合并分支","slug":"创建与合并分支","link":"#创建与合并分支","children":[{"level":3,"title":"分支小结","slug":"分支小结","link":"#分支小结","children":[]}]},{"level":2,"title":"冲突","slug":"冲突","link":"#冲突","children":[{"level":3,"title":"冲突小结","slug":"冲突小结","link":"#冲突小结","children":[]}]},{"level":2,"title":"分支管理策略","slug":"分支管理策略","link":"#分支管理策略","children":[{"level":3,"title":"分支管理惯例","slug":"分支管理惯例","link":"#分支管理惯例","children":[]},{"level":3,"title":"分支管理小结","slug":"分支管理小结","link":"#分支管理小结","children":[]}]},{"level":2,"title":"Bug 分支","slug":"bug-分支","link":"#bug-分支","children":[{"level":3,"title":"暂存小结","slug":"暂存小结","link":"#暂存小结","children":[]}]},{"level":2,"title":"Feature 分支","slug":"feature-分支","link":"#feature-分支","children":[{"level":3,"title":"删除小结","slug":"删除小结","link":"#删除小结","children":[]}]},{"level":2,"title":"多人协作","slug":"多人协作","link":"#多人协作","children":[{"level":3,"title":"推送分支","slug":"推送分支","link":"#推送分支","children":[]},{"level":3,"title":"抓取分支","slug":"抓取分支","link":"#抓取分支","children":[]},{"level":3,"title":"多人协作小结","slug":"多人协作小结","link":"#多人协作小结","children":[]}]},{"level":2,"title":"Rebase","slug":"rebase","link":"#rebase","children":[]},{"level":2,"title":"Rebase 小结","slug":"rebase-小结","link":"#rebase-小结","children":[]}],"git":{"createdTime":1591204114000,"updatedTime":1706204846000,"contributors":[{"name":"Mr.Hope","email":"zhangbowang1998@gmail.com","commits":13},{"name":"Mr.Hope","email":"mister-hope@outlook.com","commits":2}]},"readingTime":{"minutes":22.93,"words":6878},"filePathRelative":"software/git/branch.md","localizedDate":"2020年5月4日","excerpt":"","autoDesc":true}');export{m as comp,b as data};
